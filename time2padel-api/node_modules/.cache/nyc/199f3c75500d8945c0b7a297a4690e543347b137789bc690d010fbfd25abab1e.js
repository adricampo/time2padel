var cov_1ewof0pc8v=function(){var path="/Users/Adri/bootcamp/collab/skylab-bootcamp-201909/staff/adri-campo/time2padel/time2padel-api/logic/retrieve-league/index.js";var hash="ce50e92e69a5960dad1c5086478ab3e36e1eb7f7";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/Adri/bootcamp/collab/skylab-bootcamp-201909/staff/adri-campo/time2padel/time2padel-api/logic/retrieve-league/index.js",statementMap:{"0":{start:{line:1,column:62},end:{line:1,column:88}},"1":{start:{line:2,column:37},end:{line:2,column:63}},"2":{start:{line:4,column:0},end:{line:40,column:1}},"3":{start:{line:5,column:4},end:{line:5,column:29}},"4":{start:{line:6,column:4},end:{line:6,column:49}},"5":{start:{line:9,column:4},end:{line:39,column:8}},"6":{start:{line:10,column:23},end:{line:17,column:10}},"7":{start:{line:19,column:8},end:{line:19,column:64}},"8":{start:{line:19,column:21},end:{line:19,column:64}},"9":{start:{line:21,column:8},end:{line:21,column:27}},"10":{start:{line:23,column:86},end:{line:23,column:103}},"11":{start:{line:29,column:8},end:{line:35,column:11}},"12":{start:{line:30,column:12},end:{line:33,column:15}},"13":{start:{line:31,column:16},end:{line:31,column:75}},"14":{start:{line:32,column:16},end:{line:32,column:75}},"15":{start:{line:38,column:8},end:{line:38,column:79}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:17},end:{line:4,column:18}},loc:{start:{line:4,column:37},end:{line:40,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:9,column:12},end:{line:9,column:13}},loc:{start:{line:9,column:24},end:{line:39,column:5}},line:9},"2":{name:"(anonymous_2)",decl:{start:{line:29,column:42},end:{line:29,column:43}},loc:{start:{line:29,column:62},end:{line:35,column:9}},line:29},"3":{name:"(anonymous_3)",decl:{start:{line:30,column:53},end:{line:30,column:54}},loc:{start:{line:30,column:67},end:{line:33,column:13}},line:30}},branchMap:{"0":{loc:{start:{line:19,column:8},end:{line:19,column:64}},type:"if",locations:[{start:{line:19,column:8},end:{line:19,column:64}},{start:{line:19,column:8},end:{line:19,column:64}}],line:19}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"ce50e92e69a5960dad1c5086478ab3e36e1eb7f7"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();const{validate,errors:{NotFoundError,ContentError}}=(cov_1ewof0pc8v.s[0]++,require('time2padel-util'));const{models:{League,Team}}=(cov_1ewof0pc8v.s[1]++,require('time2padel-data'));cov_1ewof0pc8v.s[2]++;module.exports=function(leagueId){cov_1ewof0pc8v.f[0]++;cov_1ewof0pc8v.s[3]++;validate.string(leagueId);cov_1ewof0pc8v.s[4]++;validate.string.notVoid('leagueId',leagueId);cov_1ewof0pc8v.s[5]++;return(async()=>{cov_1ewof0pc8v.f[1]++;const league=(cov_1ewof0pc8v.s[6]++,await League.findById(leagueId).populate({path:'teams',model:'Team',populate:{path:'player1 player2',model:'User'}}));cov_1ewof0pc8v.s[7]++;if(!league){cov_1ewof0pc8v.b[0][0]++;cov_1ewof0pc8v.s[8]++;throw new NotFoundError(`League not found`);}else{cov_1ewof0pc8v.b[0][1]++;}cov_1ewof0pc8v.s[9]++;await league.save();const{_id:id,level,date,time,teams,status,playingDays,startDate}=(cov_1ewof0pc8v.s[10]++,league.toObject());// let a = playingDays[0].matches[0].teams[0]
// a = a.toString()
// const b = await Team.findById(a)
cov_1ewof0pc8v.s[11]++;await Promise.all(playingDays.map(async playingDay=>{cov_1ewof0pc8v.f[2]++;cov_1ewof0pc8v.s[12]++;await Promise.all(playingDay.matches.map(async match=>{cov_1ewof0pc8v.f[3]++;cov_1ewof0pc8v.s[13]++;match.teams[0]=await Team.findOne({_id:match.teams[0]});cov_1ewof0pc8v.s[14]++;match.teams[1]=await Team.findOne({_id:match.teams[1]});}));}));cov_1ewof0pc8v.s[15]++;return{id,level,date,time,teams,status,playingDays,startDate};})();};